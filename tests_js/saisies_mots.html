[(#AUTORISER{webmestre}|oui)
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Tests Saisies de Mots-Clés</title>
    <link rel="stylesheet" href="#CHEMIN{tests_js/qunit-1.18.0.css}">
    #INSERT_HEAD

    <script>
        $(function () {
            /* donner des classes aux saisies pour les retrouver ensuite
               plus facilement dans les tests */
            function classer_saisie_groupe (contenu_saisie, prefix='') {

                contenu_saisie.children('.choix_groupe_mots').each(function (i, groupe_mot) {
                    var classe = prefix + '-' + 'g' + parseInt(i, 10);
                    $(groupe_mot).addClass(classe);
                    classer_saisie_groupe(
                        $(groupe_mot)
                            .children('fieldset')
                            .children('.contenu'),
                        classe);
                });

                contenu_saisie.children('.choix_mot').each(function (i, mot) {
                    var classe = prefix + '-' + 'm' + parseInt(i, 10);
                    $(mot).addClass(classe);
                });
            }

            classer_saisie_groupe($('.editer_mots_arbo'));
        });
    </script>

  </head>
  <body>
    <div id="qunit"></div>
    <div id="qunit-fixture">
      #FORMULAIRE_TESTER_SAISIES_MOTS
    </div>

    [(#REM) On met un argument qui ne sert à rien dans l'action pour
            éviter un warning (SPIP 3.0.20) ]
    #BOUTON_ACTION{effacer groupe de mots-clés de test,
                   #URL_ACTION_AUTEUR{effacer_mots_test, non}}

    <script src="#CHEMIN{tests_js/qunit-1.18.0.js}"></script>
    <script>

     QUnit.module("Saisie checkbox_mots_arborescents", {
       beforeEach: function (assert) {
         $('.editer_mots_arbo').saisiesMotsClesArbo({
           demarrer_plie: true,
           vitesse_animation: 0
         });
       }
     });

     /* Si la saisie n'est pas présente, c'est probablement que les
        plugin GMA et/ou objecteur ne sont pas activés */
     QUnit.test( "Plugins GMA et objecteur activés", function( assert ) {
       assert.equal( $('.editer_mots_arbo').length, 1, "Saisie présente !" );
     });

     QUnit.test( "Plier/déplier un groupe", function( assert ) {
       var legende_g0 = $('.-g0').find('legend').first();

       assert.ok( legende_g0.hasClass('plie'), "Au début le premier groupe est replié." );

       legende_g0.click();
       assert.notOk( legende_g0.hasClass('plie'), "Un clic permet de le déplier.");

       legende_g0.click();
       assert.ok( legende_g0.hasClass('plie'), "Un nouveau clic le replie.");
     });

    </script>
  </body>
</html>
]
